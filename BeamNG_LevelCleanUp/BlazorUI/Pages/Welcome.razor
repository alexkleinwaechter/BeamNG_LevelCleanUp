@page "/"
@inject ISnackbar Snackbar
<ErrorBoundary>
    <ChildContent>
        <MudCard Class="my-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">Welcome</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudText>This is a collection of useful tools for BeamNG.drive mapbuilders. Whether you're creating a new level from scratch or fine-tuning an existing one, these tools will help you get things done faster.</MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="my-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">Before you start</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudText>
                    Don't worry about your original map files - all the heavy lifting happens in a temp folder (<code>%LocalAppData%\BeamNG_LevelCleanUp\temp</code>). 
                    Your source ZIPs stay untouched! The tool extracts maps there, does its magic, and creates new deployment ZIPs when you're done. 
                    That said, it's still smart to keep backups of your projects - better safe than sorry!
                </MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="my-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">1. Create New Level</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudText>
                    Start a fresh BeamNG level from scratch! This wizard guides you through the whole process: pick a source level to grab sky, sun, water settings from, configure your level name and size, then copy terrain materials, forest brushes, and assets from any vanilla or custom map. Finally, generate your terrain from a heightmap (PNG or GeoTIFF with real-world elevation data). Perfect for when you want a clean slate without manually setting up all the boring stuff.
                </MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="my-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">2. Generate Terrain</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudText>
                    Create or regenerate terrain (.ter) files for your level. Load a heightmap (16-bit PNG or GeoTIFF) and configure terrain materials with layer maps. Supports OSM road data for automatic road smoothing - the tool can fetch real-world road networks and smooth your terrain along them. Great for both realistic maps based on real locations and custom fantasy terrains. Save your settings as presets so you can tweak and regenerate without starting over.
                </MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="my-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">3. Map Shrinker</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudText>You can load a zipped map and let the tool search for orphaned files and assets which are not needed in the map. This can save a lot of space. All files and configurations will be checked against your scene tree with all of its dependencies and a proposal for file deletion is shown. Please check the list. It is always possible that the tool deletes too much. So always use a copy of your project! This tool is made for deleting things :-) The good thing: You still have all your crap in the project and can use it for further ideas while having a lean deployment file.</MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="my-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">4. Rename Map</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudText>You can load a zipped map and then change the name in the file system. This is important if you want to see this map beside the original one. If you customized the industrial level for example and want to have your own customized level beside industrial, you could rename it with industrial_larry :-) You can change the shown name in the map overview, too. After renaming you can build a new zipfile with the tool and you are ready to go.</MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="my-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">5. Copy Assets (Experimental)</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudText>
                    You can load a zipped map you want to copy assets from and a zipped map you want to have the assets. At the moment the tool allows to copy decalroads, decals and collada assets (dae files). You get a list of all the assets and can select the ones you want to copy. No need anymore for copying the whole folders from the desired maps. The tool copies only the needed materials and places them in a dedicated folder per assettype starting with a "MT_" for Mapping-tools.
                    <br/><br/>
                    This functionality is not well tested yet. Therefore the experimantal state. Very old maps with a lot of cs files are likely not working with this functionality. This tool doesn't like corrupted json files or files with duplicate keys (and the funny json comments) which you can even find in the vanilla maps. The tool throws an error with a detailed errormessage and if your assets aren't copied because of that you have to correct the errors and start again.
                    <br/><br/>
                    Good luck and have fun!
                </MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="my-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">6. Copy/Replace Terrain Materials</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudText>
                    Copy terrain materials from one map to another or replace existing ones while keeping the target material identity. In replace mode, textures are updated and groundcovers referencing the material are cleaned/updated automatically. In add mode, materials and dependencies are copied into a dedicated Mapping-Tools folder. You can set a custom base color for painting the terrain surface and adjust material roughness. Multiple targets can be replaced by one source (e.g., replace all grass types with snow).
                    Don't forget to add new materials from material library in the worldeditor terrain painter.
                </MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="my-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">7. Copy Forest Brushes</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudText>
                    Grab forest brushes (the painting templates for trees, rocks, grass, etc.) from any map and copy them to your project. Select the brushes you want, and the tool handles all the dependencies - mesh files, materials, textures, everything. Super handy when you see some nice vegetation in a vanilla map and want to use it in your own level without manually hunting down all the files.
                </MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="my-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">8. Convert TSStatic Assets to Forest Items</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudText>
                    You can load a zipped map and then convert your static assets placed in the scene tree to forest items.
                    After selecting a level your scene tree is shown in the tool to select the items or folders you want to convert.
                    Only assets with an identical scale on all axis and an existing rotation matrix will be converted.
                    <br/><br/>
                    During the process the tool asks if you want to delete the assets out of the scene tree.
                    If you don't delete them you will have duplicate assets. One in the tree and one in the forest items.
                    This only makes sense to check if the tool does it right :-)
                    <br/><br/>
                    A discussion if it generally makes sense to convert static assets to forest items can be found here:
                    <br/>
                    <a style="color: darkorange;" href="https://www.beamng.com/threads/converting-placed-meshes-to-forest-items.86837/">https://www.beamng.com/threads/converting-placed-meshes-to-forest-items.86837/</a>
                </MudText>
            </MudCardContent>
        </MudCard>

        <MudCard Class="my-4">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">9. Utilities</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudText>At the moment there is only one small tool in here. You can change the position (x, y, z-axis) of the whole map. The terrain and all objects within the missiongroups, decals and the forest are affected.</MudText>
            </MudCardContent>
        </MudCard>
    </ChildContent>
    <ErrorContent>
        <CustomErrorContent/>
    </ErrorContent>
</ErrorBoundary>

@code {

    protected override void OnInitialized()
    {
        Snackbar.Clear();
        Snackbar.Configuration.PositionClass = Defaults.Classes.Position.TopRight;
        Snackbar.Configuration.MaxDisplayedSnackbars = 50;
        Snackbar.Configuration.HideTransitionDuration = 300;
        Snackbar.Configuration.ShowTransitionDuration = 300;
        Snackbar.Configuration.VisibleStateDuration = 5000;
    }

}